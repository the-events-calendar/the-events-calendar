(function(m,n,b,e,h,f,a,g,k){k&&(b().isotope||debug.warn("TEC Debug: vendor bootstrapDatepicker was not loaded before its dependant file tribe-photo-view.js"));b(n).ready(function(){function u(){b(".photo-loader").hide();b("#tribe-events-photo-events").removeClass("photo-hidden").animate({opacity:"1"},{duration:600})}function p(a){q=a.width();645>q?a.addClass("photo-two-col"):a.removeClass("photo-two-col")}function r(a){b().isotope?(a.imagesLoaded(function(){a.isotope({transformsEnabled:!1,containerStyle:{position:"relative",
overflow:"visible"}},u());k&&debug.info("TEC Debug: imagesLoaded setup isotope on photo view.")}),p(a),a.resize(function(){p(a);clearTimeout(s);s=setTimeout(function(){a.isotope("reLayout")},400)})):b("#tribe-events-photo-events").removeClass("photo-hidden").css("opacity","1")}function t(b){"change_view"!=tribe_events_bar_action&&(b.preventDefault(),a.ajax_running||(a.paged=1,a.view="photo",a.popping=!1,f.pre_ajax(function(){l()})))}function l(){b("#tribe-events-header").tribe_spin();b(".photo-loader").show();
b("#tribe-events-photo-events").addClass("photo-hidden");if(!a.popping){a.ajax_running=!0;a.filter_cats&&(e.cur_url=b("#tribe-events-header").data("baseurl"));var c=b("#tribe-events-list-hash").val();a.params={action:"tribe_photo",tribe_paged:a.paged,tribe_event_display:a.view};a.url_params={action:"tribe_photo",tribe_paged:a.paged,tribe_event_display:a.view};c.length&&(a.params.hash=c);a.category&&(a.params.tribe_event_category=a.category);b(h).trigger("tribe_ev_serializeBar");a.params=b.param(a.params);
a.url_params=b.param(a.url_params);b(h).trigger("tribe_ev_collectParams");a.pushstate=!1;a.do_string=!0}g.pushstate&&!a.filter_cats?(k&&debug.time("Photo View Ajax Timer"),b(h).trigger("tribe_ev_ajaxStart").trigger("tribe_ev_photoView_AjaxStart"),console.log(a.params),b.post(TribePhoto.ajaxurl,a.params,function(c){a.initial_load=!1;f.enable_inputs("#tribe_events_filters_form","input, select");if(c.success){a.ajax_running=!1;e.ajax_response={total_count:parseInt(c.total_count),view:c.view,max_pages:c.max_pages,
tribe_paged:c.tribe_paged,timestamp:(new Date).getTime()};b("#tribe-events-list-hash").val(c.hash);var d="",d=b.isFunction(b.fn.parseHTML)?b.parseHTML(c.html):c.html;b("#tribe-events-content").replaceWith(d);b("#tribe-events-content").prev("#tribe-events-list-hash").remove();b(".tribe-events-promo").next(".tribe-events-promo").remove();"photo"===c.view?c.max_pages==a.paged?b(".tribe-events-nav-next").hide():b(".tribe-events-nav-next").show():c.max_pages==a.paged?b(".tribe-events-nav-previous").hide():
b(".tribe-events-nav-previous").show();a.page_title=b("#tribe-events-header").data("title");n.title=a.page_title;a.do_string&&history.pushState({tribe_params:a.params,tribe_url_params:a.url_params},a.page_title,e.cur_url+"?"+a.url_params);a.pushstate&&history.pushState({tribe_params:a.params,tribe_url_params:a.url_params},a.page_title,e.cur_url);r(b("#tribe-events-photo-events"));b(h).trigger("tribe_ev_ajaxSuccess").trigger("tribe_ev_photoView_AjaxSuccess");k&&debug.timeEnd("Photo View Ajax Timer")}})):
m.location=a.do_string?e.cur_url+"?"+a.url_params:e.cur_url}var d=f.get_url_param("tribe_paged"),v=f.get_url_param("tribe_event_display"),w=b("#tribe-events-photo-events"),q=0,s;a.view="photo";d&&(a.paged=d);"past"==v&&(a.view="past");r(w);g.pushstate&&!g.map_view()&&(d="action=tribe_photo&tribe_paged="+a.paged,e.params.length&&(d=d+"&"+e.params),a.category&&(d=d+"&tribe_event_category="+a.category),history.replaceState({tribe_params:d,tribe_url_params:e.params},"",location.href),b(m).on("popstate",
function(b){if(b=b.originalEvent.state)a.do_string=!1,a.pushstate=!1,a.popping=!0,a.params=b.tribe_params,a.url_params=b.tribe_url_params,f.pre_ajax(function(){l()}),f.set_form(a.params)}));b("#tribe-events").on("click","li.tribe-events-nav-next a",function(b){b.preventDefault();a.ajax_running||("past"==a.view?"1"==a.paged?a.view="photo":a.paged--:a.paged++,a.popping=!1,f.pre_ajax(function(){l()}))}).on("click","li.tribe-events-nav-previous a",function(b){b.preventDefault();a.ajax_running||("photo"==
a.view?"1"==a.paged?a.view="past":a.paged--:a.paged++,a.popping=!1,f.pre_ajax(function(){l()}))});if(g.no_bar()||g.live_ajax()&&g.pushstate)b("#tribe-bar-date").on("changeDate",function(a){g.reset_on()||t(a)});b(h).on("tribe_ev_updatingRecurrence",function(){a.popping=!1});b("#tribe-bar-form").on("submit",function(a){"change_view"!=tribe_events_bar_action&&t(a)});f.snap("#tribe-events-content","#tribe-events-content","#tribe-events-footer .tribe-events-nav-previous a, #tribe-events-footer .tribe-events-nav-next a");
b(h).on("tribe_ev_runAjax",function(){l()});k&&debug.info("TEC Debug: tribe-events-photo-view.js successfully loaded");a.view&&k&&debug.timeEnd("Tribe JS Init Timer")})})(window,document,jQuery,tribe_ev.data,tribe_ev.events,tribe_ev.fn,tribe_ev.state,tribe_ev.tests,tribe_debug);
